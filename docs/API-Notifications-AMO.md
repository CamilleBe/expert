# üîî API Notifications AMO - Documentation Frontend

## üéØ Vue d'ensemble

Cette documentation d√©crit le comportement actuel et les possibilit√©s d'int√©gration pour les notifications AMO suite √† la cr√©ation de projets clients.

---

## ‚ö° √âtat Actuel : Notifications Console

### Fonctionnement Backend

Quand un client cr√©e un projet via `POST /api/projets/`, le backend :

1. ‚úÖ **Cr√©e le projet** en base de donn√©es
2. üîç **Recherche automatiquement** les AMO dans la zone d'intervention
3. üìù **Affiche dans les logs serveur** une notification d√©taill√©e
4. ‚úÖ **R√©pond au client** avec le projet cr√©√©

### Format de Notification Console

```
üîî NOUVEAU PROJET DISPONIBLE pour 2 AMO(s):
   üìç Lieu: Paris (75001)
   üí∞ Budget: 150000‚Ç¨
   üè† Type: maison
   üìè Surface: 120m¬≤
   üìß Client: client@example.com
   üéØ AMO concern√©s:
      - Jean Dupont (R√©novation Pro)
      - Marie Martin (martin@amo.fr)
   üîó Projet ID: 15
   ‚è∞ Cr√©√© le: 14/08/2025 √† 14:30:25
   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
```

---

## üöÄ Endpoints API Disponibles

### 1. Cr√©ation de Projet (D√©clenche les Notifications)

**POST** `/api/projets/`

```javascript
// Requ√™te - Utilisateur connect√©
{
  "description": "R√©novation compl√®te d'une maison",
  "address": "123 rue de la Paix",
  "city": "Paris",
  "postalCode": "75001",
  "budget": 150000,
  "surfaceM2": 120,
  "bedrooms": 3,
  "houseType": "maison",
  "hasLand": true
}

// OU Requ√™te - Utilisateur anonyme
{
  "description": "R√©novation compl√®te d'une maison",
  "address": "123 rue de la Paix", 
  "city": "Paris",
  "postalCode": "75001",
  "budget": 150000,
  "surfaceM2": 120,
  "bedrooms": 3,
  "houseType": "maison",
  "hasLand": true,
  "clientFirstName": "Jean",
  "clientLastName": "Dupont",
  "clientEmail": "jean@example.com",
  "clientPhone": "0123456789",
  "clientPassword": "motdepasse123"
}
```

**R√©ponse (201) :**
```json
{
  "success": true,
  "data": {
    "id": 15,
    "clientId": 12,
    "description": "R√©novation compl√®te d'une maison",
    "address": "123 rue de la Paix",
    "city": "Paris", 
    "postalCode": "75001",
    "budget": 150000,
    "surfaceM2": 120,
    "bedrooms": 3,
    "houseType": "maison",
    "hasLand": true,
    "statut": "brouillon",
    "amoId": null,
    "isActive": true,
    "createdAt": "2025-01-15T14:30:25.000Z",
    "updatedAt": "2025-01-15T14:30:25.000Z",
    "client": {
      "id": 12,
      "firstName": "Jean",
      "lastName": "Dupont", 
      "email": "jean@example.com",
      "telephone": "0123456789"
    },
    "amo": null
  },
  "message": "Projet cr√©√© avec succ√®s",
  "userCreated": false,
  "accountReady": false
}
```

> **üîî Important :** √Ä ce moment, les AMO re√ßoivent automatiquement la notification console c√¥t√© serveur.

---

## üìã APIs pour Dashboard AMO

### 2. R√©cup√©rer les Projets Disponibles pour un AMO

**GET** `/api/projets/status/brouillon`

**Headers :**
```
Authorization: Bearer <token_amo>
```

**R√©ponse (200) :**
```json
{
  "success": true,
  "data": [
    {
      "id": 15,
      "clientId": 12,
      "description": "R√©novation compl√®te d'une maison",
      "address": "123 rue de la Paix",
      "city": "Paris",
      "postalCode": "75001", 
      "budget": 150000,
      "surfaceM2": 120,
      "bedrooms": 3,
      "houseType": "maison",
      "hasLand": true,
      "statut": "brouillon",
      "amoId": null,
      "createdAt": "2025-01-15T14:30:25.000Z",
      "client": {
        "id": 12,
        "firstName": "Jean",
        "lastName": "Dupont",
        "email": "jean@example.com",
        "telephone": "0123456789"
      }
    }
  ],
  "message": "3 projet(s) avec le statut brouillon trouv√©(s)"
}
```

### 3. Accepter un Projet (Nouveau endpoint d√©di√©)

**POST** `/api/projets/:id/accept`

**Headers :**
```
Authorization: Bearer <token_amo>
```

**Body :** Aucun (l'AMO est identifi√© via le token)

**R√©ponse (200) :**
```json
{
  "success": true,
  "data": {
    "id": 15,
    "amoId": 8,
    "statut": "accepte",
    "description": "R√©novation compl√®te d'une maison",
    "address": "123 rue de la Paix",
    "city": "Paris",
    "postalCode": "75001",
    "budget": 150000,
    "surfaceM2": 120,
    "bedrooms": 3,
    "houseType": "maison",
    "hasLand": true,
    "createdAt": "2025-01-15T14:30:25.000Z",
    "updatedAt": "2025-01-15T15:45:10.000Z",
    "client": {
      "id": 12,
      "firstName": "Jean",
      "lastName": "Dupont",
      "email": "jean@example.com",
      "telephone": "0123456789"
    },
    "amo": {
      "id": 8,
      "firstName": "Marie",
      "lastName": "Martin",
      "email": "marie@amo.fr",
      "telephone": "0987654321",
      "nomEntreprise": "R√©novation Pro"
    },
    "missions": []
  },
  "message": "Projet accept√© avec succ√®s! Il appara√Æt maintenant dans votre dashboard."
}
```

**Erreurs possibles :**
```json
// Projet d√©j√† accept√©
{
  "success": false,
  "message": "Ce projet a d√©j√† √©t√© accept√© par un autre AMO"
}

// Projet non disponible
{
  "success": false, 
  "message": "Ce projet n'est plus disponible"
}
```

### 4. Dashboard AMO - Mes Projets (Nouveau endpoint)

**GET** `/api/projets/my-amo-projects`

**Headers :**
```
Authorization: Bearer <token_amo>
```

**R√©ponse (200) :**
```json
{
  "success": true,
  "data": {
    "projets": [
      {
        "id": 15,
        "clientId": 12,
        "amoId": 8,
        "description": "R√©novation compl√®te d'une maison",
        "address": "123 rue de la Paix",
        "city": "Paris",
        "postalCode": "75001",
        "budget": 150000,
        "surfaceM2": 120,
        "bedrooms": 3,
        "houseType": "maison",
        "hasLand": true,
        "statut": "accepte",
        "createdAt": "2025-01-15T14:30:25.000Z",
        "updatedAt": "2025-01-15T15:45:10.000Z",
        "client": {
          "id": 12,
          "firstName": "Jean",
          "lastName": "Dupont",
          "email": "jean@example.com",
          "telephone": "0123456789"
        },
        "missions": [],
        "budgetFormate": "150 000,00 ‚Ç¨",
        "dureeJours": 2,
        "adresseComplete": "123 rue de la Paix, Paris 75001",
        "nombreMissions": 0
      }
    ],
    "statistiques": {
      "total": 3,
      "acceptes": 1,
      "enCours": 1,
      "termines": 1,
      "chiffreAffairesTotal": 450000,
      "chiffreAffairesRealise": 150000
    },
    "amoInfo": {
      "id": 8,
      "nom": "Marie Martin",
      "entreprise": "R√©novation Pro",
      "email": "marie@amo.fr",
      "zoneIntervention": ["75", "92", "94"]
    }
  },
  "message": "Dashboard AMO - 3 projet(s) r√©cup√©r√©(s)"
}
```

### 5. R√©cup√©rer les Projets d'un AMO Sp√©cifique (Admin)

**GET** `/api/projets/amo/:amoId`

**Headers :**
```
Authorization: Bearer <token_amo_ou_admin>
```

---

## üñ•Ô∏è Impl√©mentation Frontend Recommand√©e

### 1. Service API pour AMO

```javascript
// services/amoProjectService.js
import api from './api';

export const amoProjectService = {
  // R√©cup√©rer les nouveaux projets disponibles
  async getAvailableProjects() {
    return api.get('/api/projets/status/brouillon');
  },
  
  // Accepter un projet (nouveau endpoint)
  async acceptProject(projectId) {
    return api.post(`/api/projets/${projectId}/accept`);
  },
  
  // Dashboard AMO - R√©cup√©rer mes projets accept√©s
  async getMyAMOProjects() {
    return api.get('/api/projets/my-amo-projects');
  },
  
  // R√©cup√©rer ses projets en cours (ancien endpoint, pour admin)
  async getProjectsByAMO(amoId) {
    return api.get(`/api/projets/amo/${amoId}`);
  },
  
  // Filtrer par zone (c√¥t√© frontend)
  filterByZone(projects, amoZones) {
    return projects.filter(project => 
      amoZones.some(zone => 
        project.postalCode.startsWith(zone)
      )
    );
  }
};
```

### 2. Composant Vue.js - Dashboard AMO

```vue
<template>
  <div class="amo-dashboard">
    <h2>üîî Nouveaux Projets Disponibles</h2>
    
    <!-- Notifications temps r√©el -->
    <div v-if="newProjects.length === 0" class="no-projects">
      üì≠ Aucun nouveau projet dans votre zone d'intervention
    </div>
    
    <!-- Liste des projets -->
    <div v-else class="projects-grid">
      <div 
        v-for="project in filteredProjects" 
        :key="project.id"
        class="project-card"
        :class="{ 'new-project': isRecentProject(project) }"
      >
        <div class="project-header">
          <h3>{{ project.city }} ({{ project.postalCode }})</h3>
          <span v-if="isRecentProject(project)" class="new-badge">üÜï NOUVEAU</span>
        </div>
        
        <div class="project-details">
          <p><strong>üìç Adresse :</strong> {{ project.address }}</p>
          <p><strong>üí∞ Budget :</strong> {{ formatBudget(project.budget) }}</p>
          <p><strong>üìè Surface :</strong> {{ project.surfaceM2 }}m¬≤</p>
          <p><strong>üè† Type :</strong> {{ project.houseType }}</p>
          <p><strong>üõèÔ∏è Chambres :</strong> {{ project.bedrooms }}</p>
          <p><strong>üå≥ Terrain :</strong> {{ project.hasLand ? 'Oui' : 'Non' }}</p>
        </div>
        
        <div class="project-description">
          <p><strong>üìù Description :</strong></p>
          <p>{{ project.description }}</p>
        </div>
        
        <div class="client-info">
          <p><strong>üìß Client :</strong> {{ project.client.firstName }} {{ project.client.lastName }}</p>
          <p><strong>üìû Contact :</strong> {{ project.client.email }}</p>
        </div>
        
        <div class="project-actions">
          <button 
            @click="acceptProject(project.id)" 
            :disabled="loading"
            class="btn-accept"
          >
            {{ loading ? '‚è≥' : '‚úÖ' }} Accepter ce projet
          </button>
          <small>Cr√©√© le {{ formatDate(project.createdAt) }}</small>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { amoProjectService } from '../services/amoProjectService';

export default {
  name: 'AmoDashboard',
  data() {
    return {
      newProjects: [],
      loading: false,
      currentAmo: null,
      pollInterval: null
    }
  },
  
  computed: {
    // Filtrer les projets selon la zone d'intervention de l'AMO
    filteredProjects() {
      if (!this.currentAmo?.zoneIntervention) return this.newProjects;
      
      return amoProjectService.filterByZone(
        this.newProjects, 
        this.currentAmo.zoneIntervention
      );
    }
  },
  
  async mounted() {
    this.currentAmo = this.$store.state.user; // ou votre syst√®me d'auth
    await this.loadAvailableProjects();
    
    // Polling toutes les 30 secondes pour les nouveaux projets
    this.pollInterval = setInterval(this.loadAvailableProjects, 30000);
  },
  
  beforeUnmount() {
    if (this.pollInterval) {
      clearInterval(this.pollInterval);
    }
  },
  
  methods: {
    async loadAvailableProjects() {
      try {
        const response = await amoProjectService.getAvailableProjects();
        if (response.data.success) {
          const oldCount = this.newProjects.length;
          this.newProjects = response.data.data;
          
          // Notification si nouveaux projets
          if (this.newProjects.length > oldCount) {
            this.showNotification(
              `üîî ${this.newProjects.length - oldCount} nouveau(x) projet(s) disponible(s)!`
            );
          }
        }
      } catch (error) {
        console.error('‚ùå Erreur chargement projets:', error);
      }
    },
    
    async acceptProject(projectId) {
      this.loading = true;
      
      try {
        const response = await amoProjectService.acceptProject(projectId);
        
        if (response.data.success) {
          this.showNotification('‚úÖ ' + response.data.message);
          
          // Retirer le projet de la liste des projets disponibles
          this.newProjects = this.newProjects.filter(p => p.id !== projectId);
          
          // Rediriger vers le dashboard AMO ou afficher le projet accept√©
          this.$router.push('/amo-dashboard');
        }
        
      } catch (error) {
        this.showNotification('‚ùå ' + (error.response?.data?.message || 'Erreur acceptation'));
      } finally {
        this.loading = false;
      }
    },
    
    isRecentProject(project) {
      const now = new Date();
      const created = new Date(project.createdAt);
      const diffMinutes = (now - created) / (1000 * 60);
      return diffMinutes < 60; // Nouveau si cr√©√© il y a moins d'1h
    },
    
    formatBudget(budget) {
      return budget ? new Intl.NumberFormat('fr-FR', {
        style: 'currency',
        currency: 'EUR'
      }).format(budget) : 'Non sp√©cifi√©';
    },
    
    formatDate(dateString) {
      return new Date(dateString).toLocaleString('fr-FR');
    },
    
    showNotification(message) {
      // Votre syst√®me de notification
      this.$toast.success(message);
      // OU alert(message) pour test rapide
    }
  }
}
</script>

<style scoped>
.amo-dashboard {
  padding: 20px;
}

.projects-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.project-card {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 20px;
  background: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.project-card:hover {
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
  transform: translateY(-2px);
}

.project-card.new-project {
  border-color: #4CAF50;
  background: linear-gradient(135deg, #f8fff8 0%, #ffffff 100%);
}

.project-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.new-badge {
  background: #4CAF50;
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: bold;
}

.project-details, .client-info {
  margin: 15px 0;
}

.project-details p, .client-info p {
  margin: 5px 0;
  font-size: 14px;
}

.project-description {
  background: #f9f9f9;
  padding: 10px;
  border-radius: 4px;
  margin: 15px 0;
}

.project-actions {
  text-align: center;
  margin-top: 20px;
}

.btn-accept {
  background: #4CAF50;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 10px;
}

.btn-accept:hover:not(:disabled) {
  background: #45a049;
}

.btn-accept:disabled {
  background: #ccc;
  cursor: not-allowed;
}

.no-projects {
  text-align: center;
  padding: 40px;
  color: #666;
  font-size: 18px;
}
</style>
```

### 3. Composant Dashboard AMO - Mes Projets Accept√©s

```vue
<template>
  <div class="amo-my-projects">
    <header class="dashboard-header">
      <div class="amo-info">
        <h1>üìã Mon Dashboard AMO</h1>
        <p><strong>{{ amoInfo.nom }}</strong> - {{ amoInfo.entreprise }}</p>
        <p>üìß {{ amoInfo.email }}</p>
        <p>üåç Zones: {{ amoInfo.zoneIntervention?.join(', ') || 'Non sp√©cifi√©es' }}</p>
      </div>
      
      <div class="stats-grid">
        <div class="stat-card">
          <h3>{{ stats.total }}</h3>
          <p>Total Projets</p>
        </div>
        <div class="stat-card">
          <h3>{{ stats.acceptes }}</h3>
          <p>Accept√©s</p>
        </div>
        <div class="stat-card">
          <h3>{{ stats.enCours }}</h3>
          <p>En Cours</p>
        </div>
        <div class="stat-card">
          <h3>{{ stats.termines }}</h3>
          <p>Termin√©s</p>
        </div>
        <div class="stat-card">
          <h3>{{ formatCurrency(stats.chiffreAffairesTotal) }}</h3>
          <p>CA Total</p>
        </div>
        <div class="stat-card">
          <h3>{{ formatCurrency(stats.chiffreAffairesRealise) }}</h3>
          <p>CA R√©alis√©</p>
        </div>
      </div>
    </header>

    <div class="projects-section">
      <h2>üè† Mes Projets</h2>
      
      <div class="filters">
        <select v-model="statusFilter" @change="filterProjects">
          <option value="">Tous les statuts</option>
          <option value="accepte">Accept√©s</option>
          <option value="en_cours">En cours</option>
          <option value="termine">Termin√©s</option>
        </select>
      </div>

      <div v-if="filteredProjects.length === 0" class="no-projects">
        üìÇ Aucun projet dans cette cat√©gorie
      </div>

      <div v-else class="projects-list">
        <div 
          v-for="project in filteredProjects" 
          :key="project.id"
          class="project-item"
          :class="`status-${project.statut}`"
        >
          <div class="project-header">
            <h3>{{ project.city }} - {{ project.adresseComplete }}</h3>
            <span class="status-badge" :class="`status-${project.statut}`">
              {{ getStatusLabel(project.statut) }}
            </span>
          </div>

          <div class="project-content">
            <div class="project-details">
              <p><strong>üí∞ Budget :</strong> {{ project.budgetFormate }}</p>
              <p><strong>üìè Surface :</strong> {{ project.surfaceM2 }}m¬≤</p>
              <p><strong>üè† Type :</strong> {{ project.houseType }}</p>
              <p><strong>üõèÔ∏è Chambres :</strong> {{ project.bedrooms }}</p>
              <p><strong>üå≥ Terrain :</strong> {{ project.hasLand ? 'Oui' : 'Non' }}</p>
              <p><strong>üìã Missions :</strong> {{ project.nombreMissions }}</p>
            </div>

            <div class="project-description">
              <p><strong>Description :</strong></p>
              <p>{{ project.description }}</p>
            </div>

            <div class="client-info">
              <h4>üë§ Informations Client</h4>
              <p><strong>Nom :</strong> {{ project.client.firstName }} {{ project.client.lastName }}</p>
              <p><strong>Email :</strong> {{ project.client.email }}</p>
              <p><strong>T√©l√©phone :</strong> {{ project.client.telephone }}</p>
            </div>
          </div>

          <div class="project-meta">
            <p><small>Accept√© il y a {{ project.dureeJours }} jour(s)</small></p>
            <div class="project-actions">
              <button @click="viewProject(project.id)" class="btn-view">
                üëÅÔ∏è Voir d√©tails
              </button>
              <button 
                v-if="project.statut === 'accepte'"
                @click="startProject(project.id)" 
                class="btn-start"
              >
                üöÄ D√©marrer
              </button>
              <button 
                v-if="project.statut === 'en_cours'"
                @click="completeProject(project.id)" 
                class="btn-complete"
              >
                ‚úÖ Terminer
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { amoProjectService } from '../services/amoProjectService';

export default {
  name: 'AmoMyProjects',
  data() {
    return {
      projects: [],
      stats: {},
      amoInfo: {},
      loading: false,
      statusFilter: '',
      refreshInterval: null
    }
  },

  computed: {
    filteredProjects() {
      if (!this.statusFilter) return this.projects;
      return this.projects.filter(p => p.statut === this.statusFilter);
    }
  },

  async mounted() {
    await this.loadMyProjects();
    
    // Rafra√Æchir toutes les 2 minutes
    this.refreshInterval = setInterval(this.loadMyProjects, 120000);
  },

  beforeUnmount() {
    if (this.refreshInterval) {
      clearInterval(this.refreshInterval);
    }
  },

  methods: {
    async loadMyProjects() {
      this.loading = true;
      
      try {
        const response = await amoProjectService.getMyAMOProjects();
        
        if (response.data.success) {
          this.projects = response.data.data.projets;
          this.stats = response.data.data.statistiques;
          this.amoInfo = response.data.data.amoInfo;
        }
        
      } catch (error) {
        console.error('‚ùå Erreur chargement projets AMO:', error);
        this.showNotification('‚ùå Erreur lors du chargement des projets');
      } finally {
        this.loading = false;
      }
    },

    async startProject(projectId) {
      try {
        // Mettre √† jour le statut vers "en_cours"
        const response = await api.put(`/api/projets/${projectId}`, {
          statut: 'en_cours'
        });

        if (response.data.success) {
          this.showNotification('üöÄ Projet d√©marr√© avec succ√®s!');
          await this.loadMyProjects();
        }
      } catch (error) {
        this.showNotification('‚ùå ' + (error.response?.data?.message || 'Erreur'));
      }
    },

    async completeProject(projectId) {
      try {
        const response = await api.put(`/api/projets/${projectId}`, {
          statut: 'termine'
        });

        if (response.data.success) {
          this.showNotification('‚úÖ Projet termin√© avec succ√®s!');
          await this.loadMyProjects();
        }
      } catch (error) {
        this.showNotification('‚ùå ' + (error.response?.data?.message || 'Erreur'));
      }
    },

    viewProject(projectId) {
      this.$router.push(`/projects/${projectId}`);
    },

    getStatusLabel(status) {
      const labels = {
        'accepte': 'üìã Accept√©',
        'en_cours': 'üîÑ En cours',
        'termine': '‚úÖ Termin√©'
      };
      return labels[status] || status;
    },

    formatCurrency(amount) {
      return new Intl.NumberFormat('fr-FR', {
        style: 'currency',
        currency: 'EUR',
        maximumFractionDigits: 0
      }).format(amount || 0);
    },

    filterProjects() {
      // La logique de filtrage est g√©r√©e par le computed filteredProjects
    },

    showNotification(message) {
      this.$toast.success(message);
    }
  }
}
</script>

<style scoped>
.amo-my-projects {
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.dashboard-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 30px;
  border-radius: 12px;
  margin-bottom: 30px;
}

.amo-info h1 {
  margin: 0 0 10px 0;
}

.amo-info p {
  margin: 5px 0;
  opacity: 0.9;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.stat-card {
  background: rgba(255, 255, 255, 0.15);
  padding: 20px;
  border-radius: 8px;
  text-align: center;
  backdrop-filter: blur(10px);
}

.stat-card h3 {
  font-size: 24px;
  margin: 0 0 5px 0;
}

.stat-card p {
  font-size: 14px;
  margin: 0;
  opacity: 0.8;
}

.projects-section h2 {
  color: #333;
  margin-bottom: 20px;
}

.filters {
  margin-bottom: 20px;
}

.filters select {
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
}

.projects-list {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.project-item {
  border: 1px solid #ddd;
  border-radius: 12px;
  padding: 25px;
  background: white;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.project-item:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transform: translateY(-2px);
}

.project-item.status-accepte {
  border-left: 4px solid #2196F3;
}

.project-item.status-en_cours {
  border-left: 4px solid #FF9800;
}

.project-item.status-termine {
  border-left: 4px solid #4CAF50;
}

.project-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.project-header h3 {
  margin: 0;
  color: #333;
}

.status-badge {
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: bold;
  color: white;
}

.status-badge.status-accepte {
  background: #2196F3;
}

.status-badge.status-en_cours {
  background: #FF9800;
}

.status-badge.status-termine {
  background: #4CAF50;
}

.project-content {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 20px;
  margin-bottom: 20px;
}

.project-details p, .client-info p {
  margin: 8px 0;
  font-size: 14px;
}

.project-description {
  grid-column: 1 / -1;
  background: #f9f9f9;
  padding: 15px;
  border-radius: 6px;
}

.client-info h4 {
  margin: 0 0 10px 0;
  color: #666;
  font-size: 16px;
}

.project-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 15px;
  border-top: 1px solid #eee;
}

.project-actions {
  display: flex;
  gap: 10px;
}

.btn-view, .btn-start, .btn-complete {
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s ease;
}

.btn-view {
  background: #6c757d;
  color: white;
}

.btn-view:hover {
  background: #5a6268;
}

.btn-start {
  background: #007bff;
  color: white;
}

.btn-start:hover {
  background: #0056b3;
}

.btn-complete {
  background: #28a745;
  color: white;
}

.btn-complete:hover {
  background: #1e7e34;
}

.no-projects {
  text-align: center;
  padding: 60px 20px;
  color: #666;
  font-size: 18px;
  background: #f8f9fa;
  border-radius: 8px;
}

@media (max-width: 768px) {
  .project-content {
    grid-template-columns: 1fr;
  }
  
  .project-meta {
    flex-direction: column;
    gap: 15px;
    align-items: flex-start;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
</style>
```

### 4. Store Vuex/Pinia pour Notifications

```javascript
// stores/notifications.js
export const useNotificationStore = defineStore('notifications', {
  state: () => ({
    newProjectsCount: 0,
    lastCheck: null
  }),
  
  actions: {
    async checkNewProjects() {
      try {
        const response = await amoProjectService.getAvailableProjects();
        const currentCount = response.data.data.length;
        
        if (this.lastCheck && currentCount > this.newProjectsCount) {
          // Il y a de nouveaux projets!
          const newCount = currentCount - this.newProjectsCount;
          
          // Notification navigateur si permission accord√©e
          if (Notification.permission === 'granted') {
            new Notification('Nouveaux projets Experta', {
              body: `${newCount} nouveau(x) projet(s) dans votre zone`,
              icon: '/favicon.ico',
              tag: 'new-projects'
            });
          }
        }
        
        this.newProjectsCount = currentCount;
        this.lastCheck = Date.now();
        
      } catch (error) {
        console.error('‚ùå Erreur v√©rification nouveaux projets:', error);
      }
    },
    
    async startPolling() {
      // Demander permission pour les notifications
      if (Notification.permission === 'default') {
        await Notification.requestPermission();
      }
      
      // V√©rifier imm√©diatement
      await this.checkNewProjects();
      
      // Puis toutes les 30 secondes
      setInterval(this.checkNewProjects, 30000);
    }
  }
});
```

---

## üîÑ Workflow Complet

### 1. Client cr√©e un projet
```
Client ‚Üí POST /api/projets/ ‚Üí Projet cr√©√© (statut: "brouillon")
                           ‚Üì
                    üîî Notification console AMO automatique
                           ‚Üì
                    Logs serveur avec d√©tails projet + AMO zone
```

### 2. AMO consulte les nouveaux projets
```
AMO ‚Üí GET /api/projets/status/brouillon ‚Üí Liste projets disponibles
                                        ‚Üì
                                Frontend filtre par zone d'intervention
                                        ‚Üì
                                Affichage + badge "NOUVEAU"
```

### 3. AMO accepte le projet
```
AMO ‚Üí POST /api/projets/15/accept ‚Üí Projet accept√© (statut: "accepte")
                                  ‚Üì
                           üîî Log confirmation backend
                                  ‚Üì
                           Projet retir√© de la liste "brouillon"
                                  ‚Üì
                           Projet ajout√© au dashboard AMO
```

### 4. AMO g√®re ses projets accept√©s
```
AMO ‚Üí GET /api/projets/my-amo-projects ‚Üí Dashboard avec tous ses projets
                                       ‚Üì
                                Statistiques CA + projets
                                       ‚Üì
                                Actions: D√©marrer / Terminer / Voir d√©tails
```

### 5. Cycle de vie du projet
```
"brouillon" ‚Üí [AMO accepte] ‚Üí "accepte" ‚Üí [AMO d√©marre] ‚Üí "en_cours" ‚Üí [AMO termine] ‚Üí "termine"
```

---

## üéØ Points d'Attention

### ‚úÖ **Fonctionnalit√©s Pr√™tes**
- ‚úÖ Notification console automatique 
- ‚úÖ Recherche AMO par zone d'intervention
- ‚úÖ **Nouveau**: Endpoint d√©di√© pour accepter un projet
- ‚úÖ **Nouveau**: Dashboard AMO complet avec statistiques
- ‚úÖ **Nouveau**: Gestion du cycle de vie des projets
- ‚úÖ API compl√®te pour toutes les √©tapes

### üîÑ **Am√©liorations Possibles**
- üìß Notifications email automatiques
- üì± Notifications push temps r√©el
- üîî Syst√®me de notifications persistantes en BDD
- üìä Statistiques de matching AMO/projets

### üé® **C√¥t√© Frontend**
- üîÑ Polling automatique des nouveaux projets
- üîî Notifications navigateur avec permission
- üéØ Filtrage par zone d'intervention
- üì± Interface responsive pour mobile
- ‚è∞ Indicateurs "nouveau projet" avec timer

---

## üöÄ Pr√™t pour l'Int√©gration

Le backend est **100% fonctionnel** avec toutes les nouvelles fonctionnalit√©s. Le frontend peut imm√©diatement :

1. **Cr√©er des projets** ‚Üí Les AMO seront notifi√©s c√¥t√© serveur
2. **Consulter les projets disponibles** ‚Üí API `/api/projets/status/brouillon`  
3. **Accepter un projet** ‚Üí API `POST /api/projets/:id/accept`
4. **Dashboard AMO complet** ‚Üí API `/api/projets/my-amo-projects`
5. **G√©rer le cycle de vie** ‚Üí D√©marrer, terminer les projets
6. **Filtrer par zone** ‚Üí Logique frontend avec `zoneIntervention`

### üÜï **Nouveaut√©s Impl√©ment√©es**

- **Endpoint d'acceptation**: `POST /api/projets/:id/accept` - Plus simple que l'ancien syst√®me
- **Dashboard AMO**: `GET /api/projets/my-amo-projects` - Vue compl√®te des projets avec statistiques
- **Statut "accepte"**: Nouveau statut interm√©diaire entre "brouillon" et "en_cours"
- **Logs am√©lior√©s**: Confirmation d√©taill√©e lors de l'acceptation d'un projet
- **Composants frontend**: Code Vue.js complet pour les deux vues (disponibles + dashboard)

Les AMO peuvent maintenant **accepter des projets** et les **garder dans leur dashboard** avec toutes les informations client et les statistiques de leur activit√©.